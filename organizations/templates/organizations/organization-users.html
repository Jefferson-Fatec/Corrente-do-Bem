{% extends "main/base.html" %}
{% load static %}

{% block title %}{{org.organization.name}} - Doações{% endblock title %}

{% block content %}
        {% if messages %}
            {% for message in messages %}   
            <div class="container py-4">
                <div class="row">
                    <div class="alert alert-{% if message.tags == 'error' %}danger{% elif message.tags == 'success' %}success{% endif %} alert-dismissible fade show m-auto mb-4" role="alert">
                        {{ message }}
                        <br>
                        <button type="button" class="btn-close d-flex justify-content-end" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% endif %}


        <section class="news-detail-header-section text-center">
            <div class="section-overlay"></div>

            <div class="container">
                <div class="row">

                    <div class="col-lg-12 col-12">
                        <h1 class="text-white">Usuários - {{org.organization.name}}</h1>
                    </div>

                </div>
            </div>
        </section>


        <section class="news-section">

            <div class="container section-padding">
                <h2 class="mb-4 text-dark">Todos os usuários da organização</h2>
                <div class="list-group">

                    <!-- Item de exemplo -->

                    {% for org_user in users %}
                        <div class="list-group-item py-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">{{org_user.0.first_name}} {{org_user.0.last_name}}</h5>
                                <div class="row">
                                    <div class="col-12">
                                        <!-- Caso você seja admin, mostrar a opção de remover usuário -->
                                        {% if role == 0 %}
                                            {% if org_user.0 != user and org_user.1 == 1 %}
                                                <a class="btn btn-danger float-end mb-3">Remover usuário &nbsp;<i class="bi bi-trash-fill"></i></a>
                                            {% elif org_user.0 == user %}
                                                <a class="btn btn-danger float-end mb-3">Sair da organização &nbsp;<i class="bi bi-box-arrow-right"></i></a>
                                            {% endif %}
                                        {% elif role == 1 %}
                                            {% if org_user.0 == user %}
                                                <a class="btn btn-danger float-end mb-3">Sair da organização &nbsp;<i class="bi bi-box-arrow-right"></i></a>
                                            {% endif %}
                                        {% endif %}
                                    </div>
                                    <div class="col-12">
                                        {% if role == 0 %}
                                            {% if org_user.1 == 1 %}
                                                <a class="btn btn-success float-end">Promover para administrador &nbsp;<i class="bi bi-person-check"></i></a>
                                            {% endif %}
                                        {% endif %}
                                        
                                    </div>
                                </div>
                            </div>
                            <p>{{org_user.0.email}}</p>
                        </div>
                    {% endfor %}

                </div>
            </div>
        </section>
        <div class="modal fade" id="leaveOrgModal" tabindex="-1" aria-labelledby="leaveOrgModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="leaveOrgModalLabel">Excluir organização</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                    </div>
                    <div class="modal-body">
                        <p class="fs-5">Tem certeza que deseja excluir essa organização? Essa ação é <b class="text-danger">irreversível</b>.</p>

                        <p class="mt-4">Digite <b>"{{org_profile.organization.name}}"</b> para confirmar</p>
                        <form method="POST">
                            {% csrf_token %}
                            <input type="text" class="form-control my-4" id="delete-org-input" onkeyup="handleDeleteOrgInput(event)" >
                            <button type="submit" name="delete-org" class="btn btn-danger col-12" id="delete-org-btn" disabled>Excluir</button>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary justify-content-end" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>


{% endblock content %}